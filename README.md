# ğŸš€ FlarePortal

**FlarePortal** æ˜¯ä¸€ä¸ªåŸºäº Cloudflare ç”Ÿæ€æ„å»ºçš„æç®€ã€é«˜é¢œå€¼äº‘ç«¯æœåŠ¡å¯¼èˆªé—¨æˆ·ã€‚

å®ƒé‡‡ç”¨ **æ•°æ®ä¸ä»£ç è§£è€¦** çš„è®¾è®¡å“²å­¦ï¼šä½ çš„æ¨å¹¿é“¾æ¥ã€æ•æ„Ÿé…ç½®å…¨éƒ¨æ‰˜ç®¡äº Cloudflare ç¯å¢ƒå˜é‡ï¼ŒGitHub ä»“åº“ä»…ä¿ç•™çº¯å‡€çš„å±•ç¤ºé€»è¾‘ã€‚è¿™ä¸ä»…ä¿æŠ¤äº†ä½ çš„éšç§ï¼Œæ›´è®©åç»­ç»´æŠ¤å˜å¾—æ— æ¯”è½»æ¾ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

* ğŸ¨ **é«˜çº§è§†è§‰ä½“éªŒ**ï¼šåŸç”Ÿæ”¯æŒæ¯›ç»ç’ƒï¼ˆGlassmorphismï¼‰ç‰¹æ•ˆï¼ŒUI ç²¾è‡´ï¼Œæ”¯æŒè‡ªå®šä¹‰èƒŒæ™¯ã€‚
* ğŸ”’ **éšç§å®‰å…¨**ï¼šGitHub ä»“åº“ä¸åŒ…å«ä»»ä½•é“¾æ¥æ•°æ®ï¼Œæ‰€æœ‰é…ç½®é€šè¿‡ç¯å¢ƒå˜é‡æ³¨å…¥ã€‚
* ğŸ›¡ï¸ **é«˜å¯ç”¨è®¾è®¡**ï¼šæ”¯æŒä¸ºæ¯ä¸ªæ ¸å¿ƒæœåŠ¡é…ç½® **å¤‡ç”¨é“¾æ¥** (`backup_url`)ï¼Œä¸»çº¿æŒ‚äº†è‡ªåŠ¨åˆ‡å¤‡ç”¨ã€‚
* ğŸ“Š **å…¨èƒ½æ•°æ®çœ‹æ¿**ï¼šå†…ç½® D1 æ•°æ®åº“é›†æˆï¼Œç²¾å‡†è®°å½• PVã€ç‚¹å‡»æ—¶é—´ä¸æ¥æºã€‚
* ğŸ“± **å“åº”å¼å¸ƒå±€**ï¼šå®Œç¾é€‚é…ç§»åŠ¨ç«¯ã€å¹³æ¿ä¸æ¡Œé¢ç«¯ã€‚
* âš¡ **åŒæ¨¡éƒ¨ç½²**ï¼šåŒæ—¶æ”¯æŒ **Cloudflare Pages (æ¨è)** ä¸ Cloudflare Workersã€‚

---

## ğŸ› ï¸ ç¯å¢ƒå‡†å¤‡ (å…³é”®)

åœ¨éƒ¨ç½²ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ å·²ç»å‡†å¤‡å¥½äº† **Cloudflare D1 æ•°æ®åº“**ã€‚

### 1. åˆå§‹åŒ–æ•°æ®åº“

è¿›å…¥ Cloudflare åå° -> D1 -> åˆ›å»ºæ•°æ®åº“ï¼ˆä¾‹å¦‚å‘½åä¸º `nav_db`ï¼‰ï¼Œç„¶ååœ¨ **Console** æ ‡ç­¾é¡µæ‰§è¡Œä»¥ä¸‹ SQL åˆå§‹åŒ–è¡¨ç»“æ„ï¼š

```sql
DROP TABLE IF EXISTS logs;
DROP TABLE IF EXISTS stats;

-- åˆ›å»ºæ—¥å¿—è¡¨ (ç”¨äºåå°è¯¦æƒ…åˆ—è¡¨)
CREATE TABLE IF NOT EXISTS logs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    link_id TEXT,
    click_time TEXT,
    month_key TEXT
);

-- åˆ›å»ºç»Ÿè®¡è¡¨ (ç”¨äºçœ‹æ¿æ€»è§ˆ)
CREATE TABLE IF NOT EXISTS stats (
    id TEXT PRIMARY KEY,
    name TEXT,
    type TEXT,
    total_clicks INTEGER DEFAULT 0,
    year_clicks INTEGER DEFAULT 0,
    month_clicks INTEGER DEFAULT 0,
    last_year TEXT,
    last_month TEXT,
    last_time TEXT
);

```

---

## âš™ï¸ ç¯å¢ƒå˜é‡é…ç½®

æ— è®ºä½¿ç”¨ Pages è¿˜æ˜¯ Workersï¼Œéƒ½éœ€è¦åœ¨ Settings ä¸­é…ç½®ä»¥ä¸‹å˜é‡ï¼š

### 1. æ ¸å¿ƒå˜é‡ (Variables)

| å˜é‡å | å¿…å¡« | è¯´æ˜ | ç¤ºä¾‹å€¼ |
| --- | --- | --- | --- |
| **`admin`** | âœ… | åå°ç®¡ç†å¯†ç  (è®¿é—® `/admin` ç”¨) | `mypassword123` |
| **`LINKS`** | âœ… | ä¸»å¯¼èˆªé“¾æ¥é…ç½® (JSON å­—ç¬¦ä¸²) | *è§ä¸‹æ–¹æ¨¡æ¿* |
| **`FRIENDS`** | âŒ | å‹é“¾é…ç½® (JSON å­—ç¬¦ä¸²) | *è§ä¸‹æ–¹æ¨¡æ¿* |
| **`TITLE`** | âŒ | ç½‘ç«™æ ‡é¢˜ | `æˆ‘çš„äº‘ç«¯å¯¼èˆª` |
| **`SUBTITLE`** | âŒ | ç½‘ç«™å‰¯æ ‡é¢˜ | `éšæ—¶ç•…è” Â· ä¼˜è´¨èµ„æº` |
| **`img`** | âŒ | è‡ªå®šä¹‰èƒŒæ™¯å›¾ URL | `https://example.com/bg.jpg` |

### 2. D1 æ•°æ®åº“ç»‘å®š (Functions / Bindings)

* **å˜é‡å (Variable name)**: å¿…é¡»å¡«å†™ **`db`** (å°å†™)ã€‚
* **å‘½åç©ºé—´ (Namespace)**: é€‰æ‹©ä½ åˆšæ‰åˆ›å»ºçš„ D1 æ•°æ®åº“ã€‚

---

## ğŸ“ JSON é…ç½®æ¨¡æ¿

è¯·ç›´æ¥å¤åˆ¶ä»¥ä¸‹æ ¼å¼ä¿®æ”¹ï¼Œå¹¶å¡«å…¥ç¯å¢ƒå˜é‡ä¸­ã€‚

### `LINKS` (ä¸»å¯¼èˆª)

> **æ³¨æ„**ï¼š`id` å¿…é¡»å”¯ä¸€ï¼Œä¸”å°½é‡ä½¿ç”¨è‹±æ–‡ã€‚

```json
[
  {
    "id": "123",
    "name": " 123",
    "emoji": "ğŸ”ï¸",
    "note": "æ³¨æ„",
    "url": "https://ä¸»çº¿è·¯åœ°å€...",
    "backup_url": "https://å¤‡ç”¨çº¿è·¯åœ°å€..."
  },
  {
    "id": "www",
    "name": "sss",
    "emoji": "ğŸ¶",
    "note": "æ€§ä»·æ¯”ä¹‹é€‰",
    "url": "https://çº¿è·¯åœ°å€..."
  }
]

```

### `FRIENDS` (åº•éƒ¨å‹é“¾)

> **æ³¨æ„**ï¼šæ–°ç‰ˆé€»è¾‘éœ€è¦ `id` å­—æ®µæ¥è®°å½•ç‚¹å‡»ç»Ÿè®¡ã€‚

```json
[
  {
    "id": "google",
    "name": "Google",
    "url": "https://www.google.com"
  },
  {
    "id": "blog",
    "name": "æˆ‘çš„åšå®¢",
    "url": "https://blog.example.com"
  }
]

```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

### æ–¹æ¡ˆ Aï¼šCloudflare Pages (æ¨è)

æ­¤æ–¹æ¡ˆé›†æˆäº† Git ç‰ˆæœ¬ç®¡ç†ï¼Œæ›´æ–°ç»´æŠ¤æ›´æ–¹ä¾¿ã€‚

1. **Fork** æœ¬ä»“åº“åˆ°ä½ çš„ GitHubã€‚
2. è¿›å…¥ Cloudflare Dashboard -> **Pages** -> **Create a project** -> **Connect to Git**ã€‚
3. é€‰æ‹©ä½  Fork çš„ä»“åº“ï¼Œç‚¹å‡» Begin setupã€‚
4. **æ„å»ºè®¾ç½®**ï¼šé»˜è®¤å³å¯ (æ— éœ€æ„å»ºå‘½ä»¤)ã€‚
5. **ç¯å¢ƒå˜é‡**ï¼šåœ¨è®¾ç½®å‘å¯¼ä¸­æ·»åŠ  `admin`ã€`LINKS` ç­‰å˜é‡ã€‚
6. **é‡è¦æ­¥éª¤**ï¼šé¡¹ç›®åˆ›å»ºå®Œæˆåï¼Œè¿›å…¥é¡¹ç›® **Settings** -> **Functions** -> **D1 Database Bindings**ï¼Œæ·»åŠ å˜é‡å `db` å¹¶ç»‘å®šä½ çš„æ•°æ®åº“ã€‚
7. å‰å¾€ **Deployments** é€‰é¡¹å¡ï¼Œæ‰‹åŠ¨ç‚¹å‡» **Create deployment** (Retry) é‡æ–°éƒ¨ç½²ä¸€æ¬¡ä»¥ä½¿æ•°æ®åº“ç”Ÿæ•ˆã€‚

### æ–¹æ¡ˆ Bï¼šCloudflare Workers

é€‚åˆå•æ–‡ä»¶å¿«é€Ÿéƒ¨ç½²ã€‚

1. å¤åˆ¶ä»“åº“æ ¹ç›®å½•ä¸‹çš„ `worker.js` (æˆ–è€… `functions/[[path]].js`) çš„å…¨éƒ¨ä»£ç ã€‚
2. åˆ›å»ºæ–°çš„ Cloudflare Workerã€‚
3. ç‚¹å‡» **Edit Code**ï¼Œç²˜è´´ä»£ç å¹¶ä¿å­˜ã€‚
4. è¿›å…¥ **Settings** -> **Variables**ï¼š
* æ·»åŠ æ–‡æœ¬å˜é‡ (`LINKS`, `admin` ç­‰)ã€‚
* æ·»åŠ  **D1 Database Binding**ï¼Œå˜é‡åä¸º `db`ã€‚


5. ç‚¹å‡» Deployã€‚

---

## ğŸ“ˆ æ•°æ®çœ‹æ¿ä¸ç®¡ç†

éƒ¨ç½²æˆåŠŸåï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç®¡ç†ç«™ç‚¹ï¼š

* **è®¿é—®ä¸»é¡µ**ï¼š`https://ä½ çš„åŸŸå.pages.dev`
* **è®¿é—®åå°**ï¼š`https://ä½ çš„åŸŸå.pages.dev/admin`
* è¾“å…¥åœ¨ç¯å¢ƒå˜é‡ä¸­è®¾ç½®çš„ `admin` å¯†ç ã€‚
* æŸ¥çœ‹å®æ—¶ PVã€UVã€ç‚¹å‡»çƒ­åŠ›å›¾åŠè¯¦ç»†è®¿é—®æ—¥å¿—ã€‚



---

## ğŸ“‚ é¡¹ç›®ç»“æ„

```text
â”œâ”€â”€ functions/
â”‚   â””â”€â”€ [[path]].js      # Cloudflare Pages æ ¸å¿ƒé€»è¾‘ (è·¯ç”±ã€æ¸²æŸ“ã€API)
â”œâ”€â”€ index.html           # é™æ€å…¥å£å ä½ç¬¦ (Pages éœ€è¦)
â”œâ”€â”€ worker.js            # é€‚é… Workers çš„å•æ–‡ä»¶ç‰ˆæœ¬
â”œâ”€â”€ README.md            # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ LICENSE              # MIT åè®®

```

## ğŸ“„ å¼€æºåè®®

æœ¬é¡¹ç›®åŸºäº [MIT License](https://www.google.com/search?q=LICENSE) å¼€æºã€‚æ¬¢è¿ Fork ä¸ Starï¼
